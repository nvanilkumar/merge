

/*** cnvyr.min.js ***/
angular.module("homeModule").controller("filterController",["$scope","$http",function(a,f){a.selectedCityId=0;a.splcitystateId=0;a.selectedCountryId=0;if(typeof(defaultCityId)!="undefined"&&defaultCityId!=null){a.selectedCityId=defaultCityId}if(typeof(defaultSplCityStateId)!="undefined"&&defaultSplCityStateId!=null){a.splcitystateId=defaultSplCityStateId}if(typeof(defaultCountryId)!="undefined"&&defaultCountryId!=null){a.selectedCountryId=defaultCountryId}a.selectedCityName="";a.selectedCategoryId="";a.selectedCustomFilterId="";a.selectedSubcategoryId="";a.typeValue="";a.selectedCustomFilterName="";a.cityList="";a.categoryList="";a.customFilterList="";a.customDateValue="";a.pageValue=1;a.limitValue=12;a.init=function(h,g){if(g=="city"){a.cityList=h}if(g=="category"){a.categoryList=h}if(g=="customFilter"){a.customFilterList=h;a.customDateValue="";a.$watch("customDateValue",function(){})}if(g=="subCategoryList"){a.subCategoryList=h}};a.getSubCategoryCount=function(){$("#isSubCatClosed").val("1");var g="";var h={};h.countryId=a.selectedCountryId;if(a.selectedCityId>0){if(a.splcitystateId>0){h.stateId=a.splcitystateId}else{h.cityId=a.selectedCityId}}h.categoryId=a.selectedCategoryId;a.init("","subCategoryList");g=api_subcategoryEventsCount;h.eventType="nonwebinar";$("#dvLoading").show();f({method:"GET",url:g,params:h,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(k,i,l,j){a.init(k.response.count,"subCategoryList");$("#dvLoading").hide()}).error(function(k,i,l,j){window.location.href=site_url})};var e="",c="";var d="",b="";a.setFilter=function(k,i,j,m,g,l){$("#dvLoading").show();if(k=="city"){if(m!=1){a.$broadcast("angucomplete-alt:clearInput","ex5")}a.selectedCityId=i;a.splcitystateId=g||0;if(j==="All Cities"){j=defaultCountryName}a.selectedCityName=j;e="cityId";c=i;d="splCityStateId";b=g||0;$(".filterdiv").slideUp();$(".showSubCategories").html("Show Sub Categories");$("#showSubCategoriesAnchor").html("Show Sub Categories");var h={names:[e,d],values:[c,b]};if(l!="reset"){updateCookieservice(h)}}if(k=="category"){a.selectedCategoryId=i;a.selectedSubcategoryId="";if(a.selectedCategoryId==0){$("#subcat").css("display","none");$("#mobsubcat").css("cssText","display: none !important;");$("#subcat2").css("display","none");$("#subcat1").css("display","none")}else{$("#subcat").css("display","");$("#mobsubcat").css("display","");$("#subcat2").css("display","");$("#subcat1").css("display","")}if(m!=1){a.$broadcast("angucomplete-alt:clearInput","subCat")}$(".showSubCategories").html("Show Sub Categories");$("#showSubCategoriesAnchor").html("Show Sub Categories");$(".filterdiv").slideUp();var h={names:["subCategoryId","categoryId"],values:[0,i]};if(l!="reset"){updateCookieservice(h)}}if(k=="CustomFilter"){a.selectedCustomFilterId=i;a.selectedCustomFilterName=j;if(m!=1){$(".custom_date").val("")}e="dayFilter";c=i;$(".showSubCategories").html("Show Sub Categories");$("#showSubCategoriesAnchor").html("Show Sub Categories");$(".filterdiv").slideUp();var h={names:["dayFilter"],values:[i]};if(l!="reset"){updateCookieservice(h)}}if(k=="Subcategory"){if(m!=1){a.$broadcast("angucomplete-alt:clearInput","subCat")}a.selectedSubcategoryId=i;$(".filterdiv").slideUp();var h={names:["subCategoryId"],values:[i]};if(l!="reset"){updateCookieservice(h)}$(".filterdiv .subcategorysearch #subCat_value").val(j)}if(j!="Custom Date"){$("."+k+"Class").html(j)}if(j=="All Categories"){$("."+k+"Class").html("All")}if(k=="city"&&l!="reset"){a.getEventsHappeningCount(a.selectedCountryId,a.selectedCityId,l)}a.pageValue=1;a.limitValue=12;if(k!="CustomFilter"&&k!="Subcategory"&&l!="reset"){a.getTopBannersList(a.selectedCountryId,a.selectedCityId,a.selectedCategoryId,l);a.getBottomBannersList(a.selectedCountryId,a.selectedCityId,a.selectedCategoryId)}if(l!="reset"){a.getEventList(a.selectedCountryId,a.selectedCityId,a.selectedCategoryId,a.selectedSubcategoryId,a.selectedCustomFilterId,a.typeValue,a.pageValue,a.limitValue,a.splcitystateId,l)}if($("#viewMoreCat").attr("aria-expanded")){a.viewMoreSubcategories("filter")}};a.viewMoreSubcategories=function(g){var j=a.selectedCityId;var i=a.selectedCountryId;if(g!="filter"){$("#dvLoading").show()}var h="?countryId="+i+"&major=0&eventType=nonwebinar";if(j!=0&&j!=""){if(a.splcitystateId>0){h+="&stateId="+a.splcitystateId}else{h+="&cityId="+j}}h+="&eventMode=0";f({method:"GET",url:api_subcategoryEventsCount+h,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(p,k,q,n){$("#dvLoading").hide();a.subcatErrorMessage="";var o=p.response.count.length;if(o==0){a.subcatErrorMessage=p.response.messages[0]}var m=[];var l="";$.each(p.response.count,function(r,s){m.push(s)});a.subcatEventsData=m}).error(function(m,k,n,l){$("#dvLoading").hide();a.subcatErrorMessage=m.response.messages[0];window.location.href=site_url})};
a.reset=function(){$("#dvLoading").show();a.pageValue=1;a.limitValue=12;a.selectedCityId=0;a.selectedCategoryId=0;a.selectedCustomFilterId=6;a.selectedSubcategoryId=0;a.splcitystateId=0;$(".custom_date").val("");$(".CustomFilterClass").html("All Time");$(".showSubCategories").html("");$("#showSubCategoriesAnchor").html("");$("#subcat").css("display","none");$("#mobsubcat").css("cssText","display: none !important;");$("#subcat2").css("display","none");$("#subcat1").css("display","none");$(".categoryClass").html("All");$(".cityClass").html(defaultCountryName);a.selectedCityName="All Cities";a.selectedCustomFilterName="All Time";a.$broadcast("angucomplete-alt:clearInput","ex5");a.$broadcast("angucomplete-alt:clearInput","subCat");a.$broadcast("angucomplete-alt:clearInput","subCat");var g={names:["cityId","categoryId","dayFilter","subCategoryId","splCityStateId"],values:[a.selectedCityId,a.selectedCategoryId,a.selectedCustomFilterId,a.selectedSubcategoryId,a.splcitystateId]};updateCookieservice(g);$(".filterdiv").hide();a.getEventList(a.selectedCountryId,a.selectedCityId,a.selectedCategoryId,0,a.selectedCustomFilterId,0,a.pageValue,a.limitValue,0,"reset");a.getEventsHappeningCount(a.selectedCountryId,0);a.getTopBannersList(a.selectedCountryId,"","");a.getBottomBannersList(a.selectedCountryId,"","","reset");if($("#viewMoreCat").attr("aria-expanded")){a.viewMoreSubcategories("filter")}};a.indexedArray=function(h,g){var i={};angular.forEach(h.response.count,function(k,j){if(g=="city"){var j=k.type+"-"+k.id}if(g=="category"){var j=k.id}if(g=="customFilter"){var j=k.id}i[j]=k.count});return i};a.updateCityCount=function(g,h){angular.forEach(g,function(k){var j="city";var l=k.id;if(k.splcitystateid>0){var j="state";var l=k.splcitystateid}var i=j+"-"+l;if(h[i]>0){k.eventCount="("+h[i]+")";$("#"+k.id+"_city").css("display","inline-block");$("#"+k.id+"_mobcity").css("display","inline-block");$("#"+k.id+"_scrollcity").css("display","inline-block")}else{$("#"+k.id+"_city").css("display","none");$("#"+k.id+"_mobcity").css("cssText","display: none !important;");$("#"+k.id+"_scrollcity").css("display","none")}})};a.updateCount=function(h,i,g){angular.forEach(h,function(j){if(i.hasOwnProperty(j.id)){if(i[j.id]>0){j.eventCount="("+i[j.id]+")";$("#"+j.id+"_category").css("display","inline-block");$("#"+j.id+"_mobcategory").css("display","inline-block");$("#"+j.id+"_scrollctg").css("display","inline-block");if(g=="customFilter"){$("#"+j.id+"_dates").css("display","inline-block");$("#"+j.id+"_scrolldt").css("display","inline-block")}}else{if(g=="customFilter"){$("#"+j.id+"_dates").css("cssText","display: none !important;");$("#"+j.id+"_scrolldt").css("display","none")}$("#"+j.id+"_category").css("display","none");$("#"+j.id+"_mobcategory").css("cssText","display: none !important;");$("#"+j.id+"_scrollctg").css("display","none")}}else{if(g=="customFilter"&&j.id==6){j.eventCount=""}else{$("#"+j.id+"_category").css("display","none");$("#"+j.id+"_mobcategory").css("cssText","display: none !important;");$("#"+j.id+"_scrollctg").css("display","none")}}})};a.defaultFilter=function(){a.selectedCityId=defaultCityId;a.selectedCountryId=defaultCountryId;var g="";if(defaultCityName==="All Cities"){g=defaultCountryName}else{g=defaultCityName}a.selectedCityName=g};a.getEventCount=function(g,i,k){var h="";var j={};j.countryId=a.selectedCountryId;$("#dvLoading").show();if(i=="city"){$(".showSubCategories").html("Show Sub Categories");$("#showSubCategoriesAnchor").html("Show Sub Categories");h=api_cityEventsCount;if(a.selectedCategoryId>0){j.categoryId=a.selectedCategoryId}if(a.selectedSubcategoryId>0){j.subcategoryId=a.selectedSubcategoryId}if(a.selectedCustomFilterId>0){j.day=a.selectedCustomFilterId;if(a.selectedCustomFilterId==7){j.dateValue=$("#datepicker").val()}}}if(i=="category"){$(".showSubCategories").html("Show Sub Categories");$("#showSubCategoriesAnchor").html("Show Sub Categories");h=api_categoryEventsCount;j.major=0;if(a.selectedCityId>0){if(a.splcitystateId>0){j.stateId=a.splcitystateId}else{if(a.splcitystateId>0){j.stateId=a.splcitystateId}else{j.cityId=a.selectedCityId}}}if(a.selectedCategoryId>0){j.categoryId=a.selectedCategoryId}if(a.selectedCustomFilterId>0){j.day=a.selectedCustomFilterId;if(a.selectedCustomFilterId==7){j.dateValue=$("#datepicker").val()}}}if(i=="customFilter"){$(".showSubCategories").html("Show Sub Categories");$("#showSubCategoriesAnchor").html("Show Sub Categories");h=api_filterEventsCount;if(a.selectedCityId>0){if(a.splcitystateId>0){j.stateId=a.splcitystateId}else{j.cityId=a.selectedCityId}}if(a.selectedCategoryId>0){j.categoryId=a.selectedCategoryId}}j.eventType="nonwebinar";j.eventMode=0;f({method:"GET",url:h,params:j,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(n,l,p,m){var o=a.indexedArray(n,i);if(i=="city"){a.updateCityCount(a.cityList,o);a.allCityCount="("+n.response.allCount+")"}else{if(i=="category"){a.updateCount(a.categoryList,o,i);
a.allCategoryCount="("+n.response.allCount+")"}else{if(i=="customFilter"){a.updateCount(a.customFilterList,o,i)}}}if(k!="reset"){$("#dvLoading").hide()}}).error(function(n,l,o,m){$("#dvLoading").hide();console.log("getEventCount Something went wrong please try again")})};a.getEventsHappeningCount=function(i,h){var g="?countryId="+i+"&major=0&eventType=nonwebinar";if(h!=0&&h!=""){if(a.splcitystateId>0){g+="&stateId="+a.splcitystateId}else{g+="&cityId="+h}}g+="&eventMode=0";f({method:"GET",url:api_categorycityEventsCount+g,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(m,k,n,l){var j=[];$.each(m.response.count,function(o,p){j.push(p)});a.eventsData=j;$("#totalCount").text(m.response.total);if(m.response.total==0){$(".eventsCat").css("display","none")}else{$(".eventsCat").css("display","block")}}).error(function(l,j,m,k){window.location.href=site_url})};a.getTopBannersList=function(j,i,g){$(".carousel-inner").hide();var h="?countryId="+j;if(i>0){h+="&cityId="+i}if(g>0){h+="&categoryId="+g}h+="&type=1";f({method:"GET",url:api_bannerList+h,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(q,p,m,n){$(".carousel-inner").show();if(q.response.total>0){var r=q.response.total;$(".carousel-inner .item").remove();for(var o=0;o<r;o++){var l=q.response.bannerList[o];var s=l.title;var t=l.bannerImage||0;var k=l.url;if(typeof(t)!="undefined"&&t.length>0){$('<div class="item"><a href="'+k+'" target="_self"><img src="'+t+'" title="'+s+'" alt="'+s+'" target="_self" style="width:100% !important" ></a><div class="carousel-caption"></div></div>').appendTo(".carousel-inner")}}$(".item").first().addClass("active");$(".carousel-indicators > li").first().addClass("active");$("#carousel-example-generic").carousel()}else{$(".carousel-inner").hide()}}).error(function(m,k,n,l){window.location.href=site_url})};a.getBottomBannersList=function(k,j,g,i){var h="?countryId="+k;if(j>0){h+="&cityId="+j}if(g>0){h+="&categoryId="+g}h+="&type=2";f({method:"GET",url:api_bannerList+h,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(q,p,m,n){var r=q.response.total;if(r>0){var u="";var t=q.response.bannerList[0].title;var o=q.response.bannerList[0].bannerImage;var l=q.response.bannerList[0].url;var s="_self";u+='<a href="'+l+'" target="'+s+'"> <img src="'+o+'" title="'+t+'" alt="'+t+'"></a>';$("#bottomBanner").show();$("#bottomBanner").html(u)}else{$("#bottomBanner").hide()}if(i=="reset"){setTimeout(function(){$("#dvLoading").hide()},2000)}}).error(function(n,l,o,m){window.location.href=site_url})};a.getEventList=function(i,l,g,j,p,o,n,k,h,m){var r="";var q="none";r+="?countryId="+i;if(l!=0){if(h!=0){r+="&stateId="+h}else{r+="&cityId="+l}}else{if(l==0){q="block"}}if(g!=0){r+="&categoryId="+g}if(j!=0){r+="&subcategoryId="+j}if(p!=0){r+="&day="+p}if(p==7){r+="&dateValue="+$("#datepicker").val()}if(o!=0){r+="&type="+o}r+="&page="+n+"&limit="+k;r+="&eventMode=0";r+="&eventType=nonwebinar";$("#dvLoading").show();f({method:"GET",url:api_eventList+r,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(y,w,u,v){var C="";$("#totalResultCount").val("0");if(y.response.total>0){$("#totalResultCount").val(y.response.total);if(typeof tsa!==typeof undefined){var B=$(".CustomFilterClass").html();var t=new Array(B.charAt(0).toUpperCase()+B.slice(1));console.log($("#totalResultCount").val());console.log($(".cityClass").html());console.log($(".categoryClass").html());console.log(t);tsa.activity_data={sresults:$("#totalResultCount").val(),scity:$(".cityClass").html(),scategory:$(".categoryClass").html(),ssubcategory:"",sfilter:t};if(typeof window.ts!==typeof undefined){ts.save_parameters()}}var z=y.response.eventList.length;for(var x=0;x<z;x++){var s=y.response.eventList[x];var A=s.eventUrl;if(s.eventExternalUrl!=undefined){A=s.eventExternalUrl}C+='<li class="col-xs-12 col-sm-6 col-md-4 col-lg-4 thumbBlock">';C+='<a href="'+A+'" class="thumbnail">';C+='<div class="eventImg">';C+='<img src="'+s.thumbImage+'" width="" height="" alt="'+s.title+' " title="'+s.title+'" ';C+=" onError=\"this.src='"+s.defaultThumbImage+"'\"";C+=" />";C+="</div><h2>";C+='<span class="eveHeadWrap">'+s.title+"</span>";C+='</h2><div class="info">';C+="<span>"+convertDate(s.startDate)+"</span> ";C+="</div>";C+='<div class="eventCity" style="display:'+q+'">';C+="<span>"+s.cityName+"</span></div>";C+='<div class="overlay"><div class="overlayButt"><div class="overlaySocial">';C+='<span class="icon-fb"></span> <span class="icon-tweet"></span>';C+='<span class="icon-google"></span></div></div></div>';C+='</a> <a href="'+A+'" class="category">';C+='<span class="icon1-'+s.categoryName.toLowerCase().replace(" ","")+" col"+s.categoryName.toLowerCase().replace(" ","")+'"></span>';
C+='<span class="catName"><em>'+s.categoryName+"</em></span> </a> </li>"}$("ul#eventThumbs").html(C);$("#noRecords").html("");if(y.response.nextPage==false){$("#viewMoreEvents").css("display","none");$("#noMoreEvents").css("display","block")}else{a.pageValue++;$("#viewMoreEvents").css("display","inline-block");$("#noMoreEvents").css("display","none")}}else{if(n==1){$("ul#eventThumbs").html(C);$("#noRecords").html(y.response.messages);$("#noMoreEvents").css("display","none")}$("#viewMoreEvents").css("display","none")}if(m!="reset"){$("#dvLoading").hide();$("html,body").animate({scrollTop:0},1000)}}).error(function(u,s,v,t){window.location.href=site_url})};a.getMoreEvents=function(){$("#viewMoreEvents").addClass("loading");if(a.pageValue==1){a.pageValue=2}var h="";var g="none";h+="?countryId="+a.selectedCountryId;if(a.selectedCityId>0){if(a.splcitystateId>0){h+="&stateId="+a.splcitystateId}else{h+="&cityId="+a.selectedCityId}}else{if(a.selectedCityId==0){g="block"}}if(a.selectedCategoryId>0){h+="&categoryId="+a.selectedCategoryId}if(a.selectedSubcategoryId>0){h+="&subcategoryId="+a.selectedSubcategoryId}if(a.selectedCustomFilterId>0){h+="&day="+a.selectedCustomFilterId}if(a.typeValue!=0){h+="&type="+a.typeValue}if(a.selectedCustomFilterId==7){h+="&dateValue="+$("#datepicker").val()}h+="&page="+a.pageValue+"&limit="+a.limitValue;h+="&eventMode=0";f({method:"GET",url:api_eventList+h,async:false,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"bearer 930332c8a6bf5f0850bd49c1627ced2092631250"}}).success(function(n,m,k,l){if(n.response.total>0){var r="";var p=n.response.eventList.length;for(var o=0;o<p;o++){var j=n.response.eventList[o];var q=j.eventUrl;if(j.eventExternalUrl!=undefined){q=j.eventExternalUrl}r+='<li class="col-xs-12 col-sm-6 col-md-4 col-lg-4 thumbBlock">';r+='<a href="'+q+'" class="thumbnail">';r+='<div class="eventImg">';r+='<img src="'+j.thumbImage+'" width="" height="" alt="'+j.title+'" title="'+j.title+'"';r+=" onError=\"this.src='"+j.defaultThumbImage+"'\"";r+=" />";r+="</div><h2>";r+='<span class="eveHeadWrap">'+j.title+"</span>";r+='</h2><div class="info">';r+="<span>"+convertDate(j.startDate)+"</span> ";r+="</div>";r+='<div class="eventCity" style="display:'+g+'">';if(j.cityName!=""&&j.cityName!="undefined"){r+="<span>"+j.cityName+"</span>"}r+='</div><div class="overlay"><div class="overlayButt"><div class="overlaySocial">';r+='<span class="icon-fb"></span> <span class="icon-tweet"></span>';r+='<span class="icon-google"></span></div></div></div>';r+='</a> <a href="'+q+'" class="category">';r+='<span class="icon1-'+j.categoryName.toLowerCase().replace(" ","")+" col"+j.categoryName.toLowerCase().replace(" ","")+'"></span>';r+='<span class="catName"><em>'+j.categoryName+"</em></span> </a> </li>"}$("ul#eventThumbs").append(r);a.pageValue++;$("#viewMoreEvents").removeClass("loading");if(n.response.nextPage==false){$("#viewMoreEvents").css("display","none");$("#noMoreEvents").css("display","block")}else{if(n.response.nextPage==true){$("#viewMoreEvents").css("display","inline-block");$("#noMoreEvents").css("display","none")}}}else{if(a.pageValue==1){$("ul#eventThumbs").append(r)}$("#viewMoreEvents").css("display","none");$("#noMoreEvents").css("display","block")}}).error(function(k,i,l,j){window.location.href=site_url})};a.citySearchValue="";a.subCatSearchValue="";a.cityChanged=function(g){a.citySearchValue=g};a.remoteRequestCity=function(g){return{major:0,keyWord:g,countryId:a.selectedCountryId,limit:5}};a.citySelected=function(g){$("#ex5 div input").val(g.title);a.setFilter("city",g.originalObject.id,g.title,1,0)};a.subcategorySelected=function(g){a.setFilter("Subcategory",g.originalObject.id,g.title,1,0)};a.remoteRequestSubCat=function(g){return{major:1,keyword:g,categoryId:a.selectedCategoryId,limit:5}};a.subCatChanged=function(g){a.subCatSearchValue=g}}]);